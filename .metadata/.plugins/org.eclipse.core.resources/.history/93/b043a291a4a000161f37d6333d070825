
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%
	// 실습 => 2개의 입력창의 쿠키값을 읽어서 셋팅하기
	// 단 , 쿠키값을 뽑는 멤버 메소드를 구성하여 데이터를 획득하고 expression으로 값세팅
	// 이미 넣어져 있는 값을 이용하여 
%>
<%!
	public String getCookie( String key, Cookie[] cookies )
	{
		if( cookies != null )
			for( Cookie c : cookies ){
				if( c.getName().equals(key) )	// 동일한 키가 존재할시 
				{
					return c.getValue();				// 값획득
				}
			}
		return "";
	}
%>    
<%
	// 쿠키 읽기
	Cookie[] cookies = request.getCookies();
	if( cookies != null )
		for( Cookie c : cookies ){
			System.out.println( c.getName() + " / " + c.getValue()  );
		}
	// 실습 => 2개의 입력창에 각각 쿠키값을 읽어서 세팅하시오.
	//        단, 쿠키값을 뽑는 맴버 메소드를 구성하여 데이터를 획득하고 expression으로 값세팅
%>    
<!DOCTYPE>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script> <!-- jquery 추가하기 -->
<script type="text/javascript">
	// interpretor 방식으로 위에서 한줄씩 읽어서 실행한다.
	// html 문서가 모두 메모리에 올라왔다 !! 로드됨!!
	$(document).ready(function(){
		//alert("hi");
		// selector : 대상을 찾는다 + 이벤트, 기타 처리 
		// css 제공 / $("*") , $("body"), $("fieldset input")
		// $("fieldset>input"), $(filedset, input), $(".style"),
		//$("#change").onclick(function(){});
		console.log($("#change"));
		$("#change").on("click", function(){
			// ajax 처리 form이 없어서 사용한다.
			// ajax를 만들어 사용할때 만드는 기초적인 스타일
			$.ajax({
				// key and value를 넣는다.
				url :"/Hello/cookieProc",
				type : "post",
				data: $("form".serialize()), // 
				dataType : "json", // 밑의 데이터가 json타입으로 들어온다.
				success :function(data){
					console.log("성공", data);
				},
				error:function(err){
					console.log("실패", err);
				}
			}); 
		});
		$("#delete").on("click", function(){
			
		});
	})
</script>
</head>
<body>
	<fieldset>
		<form action="">
			<input type="text" name="uid" value="<%=getCookie("uid", cookies) %>" /><br />
			<input type="text" name="upw" value="<%=getCookie("age", cookies) %>" />
			<button id="change">변경</button><button id="delete">삭제</button>
		</form>
	</fieldset>
</body>
</html>
<%

%>
