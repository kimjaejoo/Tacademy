<%@page import="java.sql.PreparedStatement"%>
<%@page import="java.sql.DriverManager"%>
<%@page import="java.sql.Connection"%>
<%@page import="com.google.gson.Gson"%>
<%@page import="com.model.ResError"%>
<%@ page language="java" contentType="text/plain; charset=UTF-8"
	pageEncoding="UTF-8"%>

<%
	// 0. 파라미터 체크
	String os = request.getParameter("os");
	if (os == null && os.trim().length()==0) {
		// 에러 {"code" :-1, "msg" : "매개변수가 누락되었습니다."}
		ResError error = new ResError(-1, "매개변수가 누락되었습니다.");

		// 객체 => json으로 
		Gson gson = new Gson();
		String json = gson.toJson(error);
		out.print(json);
		return;
	}
	out.print("test");
	// 1. db 드라이버 로드
	try {
		Class.forName("com.mysql.jdbc.Driver");
		Connection conn = DriverManager
				.getConnection("jsptest.cpkkponxntb7.ap-northeast-2.rds.amazonaws.com/Tacademy?"
						+ "user=test&password=test1234");
		// 2. 커넥션
		// 2. db커넥션
		// 3. 쿼리
		String sql = "select * from tbl_version where os = ? ";
		PreparedStatement pstmt = conn.prepareStatement(sql);
		pstmt.seti
		// 4. 디비 클로즈
		conn.close();
		// 5. 응답
		// {"code" : 1, "msg" : {"os : a", "version" : "1.0.0" , "url" : "http://m.naver.com"}}
	} catch (Exception e) {

	}
%>